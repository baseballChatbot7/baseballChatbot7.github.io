I"¤<h1 id="elasticsearch-1">Elasticsearch-1</h1>
<h2 id="abstract">Abstract</h2>

<p>ì±—ë´‡ì—ì„œ ì§ˆë¬¸ì´ ë“¤ì–´ì™”ì„ ë•Œ, ê·¸ì— ëŒ€ì‘í•˜ëŠ” ì ì ˆí•œ ë¬¸ì„œë¥¼ ì°¾ì•„ì¤„ í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤. ì´ë•Œ, ê²€ìƒ‰ ì—”ì§„ ì˜¤í”ˆ ì†ŒìŠ¤ì¸ Elasticsearchë¥¼ ì‚¬ìš©í•´ì„œ Retrievalë¥¼ êµ¬í˜„í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” Back-Endì— í•´ë‹¹í•˜ëŠ” ë‚´ìš©ë³´ë‹¤ëŠ” Elasticsearchì˜ ê²€ìƒ‰ ì„±ëŠ¥ì„ ì˜¬ë¦¬ê¸° ìœ„í•œ ë‚´ìš©ì„ ë‹¤ë£¨ë ¤ê³  í•©ë‹ˆë‹¤.</p>

<h2 id="setting">Setting</h2>

<p>í•´ë‹¹ ë‚´ìš©ì€ ì„œë²„ìƒì— Elasticsearchê°€ ì„¤ì¹˜ë˜ì–´ ìˆë‹¤ëŠ” ê°€ì •í•˜ì— ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</p>

<pre><code>!pip install elasticsearch
elasticsearch-7.12.1/bin/elasticsearch-plugin install analysis-nori # í•œêµ­ì–´ í† í¬ë‚˜ì´ì € ì„¤ì¹˜
</code></pre>
<p>Elasticsearchë¥¼ íŒŒì´ì¬ì—ì„œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì²˜ìŒì—ëŠ” Elasticsearchì— í•œêµ­ì–´ í† í¬ë‚˜ì´ì €ê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ì €í¬ê°€ ë”°ë¡œ ì„¤ì¹˜í•´ì¤„ í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.</p>

<pre><code>from elasticsearch import Elasticsearch
es = Elasticsearch('localhost:9200')
print(es.info())
</code></pre>
<p>ì´ì œ íŒŒì´ì¬ì— Elasticsearchë¥¼ ì—°ê²°í•©ë‹ˆë‹¤. ì„¸íŒ…ì— ë”°ë¼ ë‹¤ë¥´ê² ì§€ë§Œ, ê°œì¸ ì»´í“¨í„°ì—ì„œ ì‚¬ìš©í•œë‹¤ë©´ â€˜localhost:9200â€™ë¡œ ì—°ê²°í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ë§ˆì§€ë§‰ì˜ printë¬¸ì´ ì •ìƒì ìœ¼ë¡œ ì¶œë ¥ì´ ë˜ë©´, Elasticsearchê°€ ì •ìƒì ìœ¼ë¡œ ì—°ê²°ëœ ê²ƒì…ë‹ˆë‹¤.</p>

<pre><code>es.indices.create(index = 'document',
                  body = {
                      'settings':{
                          'analysis':{
                              'analyzer':{
                                  'my_analyzer':{
                                      "type": "custom",
                                      'tokenizer':'nori_tokenizer',
                                      'decompound_mode':'mixed',
                                      'stopwords':'_korean_',
                                      'synonyms':'_korean_',
                                      "filter": ["lowercase",
                                                 "my_shingle_f",
                                                 "nori_readingform",
                                                 "nori_number",
                                                 "cjk_bigram",
                                                 "decimal_digit",
                                                 "stemmer",
                                                 "trim"]
                                  }
                              },
                              'filter':{
                                  'my_shingle_f':{
                                      "type": "shingle"
                                  }
                              }
                          },
                          'similarity':{
                              'my_similarity':{
                                  'type':'BM25',
                              }
                          }
                      },
                      'mappings':{
                          'properties':{
                              'title':{
                                  'type':'text',
                                  'analyzer':'my_analyzer',
                                  'similarity':'my_similarity'
                              },
                              'text':{
                                  'type':'text',
                                  'analyzer':'my_analyzer',
                                  'similarity':'my_similarity'
                              }
                          }
                      }
                  }
                  )
print(es.indices.get('document'))
</code></pre>
<p>Elasticsearchì— ë¬¸ì„œë¥¼ ì €ì¥í•  indexë¥¼ ìƒì„±í•©ë‹ˆë‹¤. indexëŠ” í¬ê²Œ settingsê³¼ mappingsë¡œ ë‚˜ë‰©ë‹ˆë‹¤. settingsì—ëŠ” ì‚¬ìš©í•œ ê¸°ëŠ¥ë“¤ì„ ì¤€ë¹„í•˜ê³  mappingsì—ëŠ” ë°ì´í„° ì–‘ì‹ì„ ì¤€ë¹„í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ë§ˆì§€ë§‰ì˜ printë¬¸ì´ ì •ìƒì ìœ¼ë¡œ ì¶œë ¥ì´ ë˜ë©´, index ìƒì„±ì´ ì™„ë£Œëœ ê²ƒì…ë‹ˆë‹¤.</p>

<pre><code>import os

for file_name in os.listdir('/Users/kimnamhyeok/PycharmProjects/pythonProject/club'):
    if file_name != '.DS_Store':
        with open('/Users/kimnamhyeok/PycharmProjects/pythonProject/club/'+file_name, 'r') as f:
            contents = f.read()
        es.index(index='document', body = {"title" : file_name.split('.')[0], "text" : contents})

for file_name in os.listdir('/Users/kimnamhyeok/PycharmProjects/pythonProject/player'):
    if file_name != '.DS_Store':
        with open('/Users/kimnamhyeok/PycharmProjects/pythonProject/player/'+file_name, 'r') as f:
            contents = f.read()
        es.index(index='document', body = {"title" : file_name.split('.')[0], "text" : contents})

</code></pre>
<p>Elasticsearchì— íŒ€ ë¬¸ì„œì™€ ì„ ìˆ˜ ë¬¸ì„œë¥¼ ì €ì¥í•©ë‹ˆë‹¤. bulk ë‹¨ìœ„ë¡œ í•œ ë²ˆì— ë„£ëŠ” ë°©ë²•ë„ ìˆìœ¼ë‚˜, ìµìˆ™í•˜ì§€ ì•Šì€ ê´€ê³„ë¡œ ì •í™•í•˜ê²Œ í•˜ê¸° ìœ„í•´ ë¬¸ì„œ í•˜ë‚˜ì”© ë„£ì–´ì£¼ì—ˆìŠµë‹ˆë‹¤.</p>

<pre><code>question = input()

query = {
    'query': {
        'bool': {
            'should': [
                {'match': {'title': question}},
                {'match': {'text': question}}
            ]
        }
    }
}

doc = es.search(index='document',body=query,size=10)['hits']['hits']

print(doc[0])
</code></pre>
<p>ì´ì œ ì„¸íŒ…ì„ ë§ˆì¹˜ê³  ì •ìƒì ìœ¼ë¡œ ê²€ìƒ‰ì´ ë˜ëŠ”ì§€ í™•ì¸í•  ì°¨ë¡€ì…ë‹ˆë‹¤. questionì„ í†µí•´ì„œ ì •ìƒì ìœ¼ë¡œ ê²€ìƒ‰ì´ ë˜ë©´, Elasticsearch ì„¸íŒ…ì´ ì™„ë£Œëœ ê²ƒì…ë‹ˆë‹¤.</p>

<h1 id="ëìœ¼ë¡œ">ëìœ¼ë¡œ</h1>

<p>Elasticsearchì— ëŒ€í•œ ê¸°ë³¸ì ì¸ ì„¸íŒ…ì„ ë§ˆì³¤ìŠµë‹ˆë‹¤. ì˜ˆìƒ ì§ˆë¬¸ì—ëŠ” ì„ ìˆ˜ëª…ì´ë‚˜ íŒ€ëª…ê³¼ ê°™ì€ ê³ ìœ ëª…ì‚¬ê°€ ì‚¬ìš©ë  ê°€ëŠ¥ì„±ì´ ë†’ê¸° ë•Œë¬¸ì—, Elasticsearchë§Œìœ¼ë¡œë„ Retrievalì—ì„œ ì¢‹ì€ ì„±ëŠ¥ì„ ë‚¼ ìˆ˜ ìˆì„ ê²ƒì´ë¼ê³  ìƒê°í•©ë‹ˆë‹¤. ë‹¤ìŒì—ëŠ” <a href="https://github.com/javacafe-project/elasticsearch-plugin">ìë°”ì¹´í˜ Elasticsearch í”ŒëŸ¬ê·¸ì¸</a> ê¸°ëŠ¥ì„ ì¶”ê°€í•´ë³´ë ¤ê³  í•©ë‹ˆë‹¤.</p>
:ET